<!DOCTYPE html>
<html lang="en">
<head>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106754474-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-106754474-1');
</script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>Programming with Refinement Types - a short tutorial</title>

    <link href="./css/bootstrap.css" rel="stylesheet">
    <link href="./css/bootstrap-theme.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./css/rust-book.css">
    <link rel="stylesheet" type="text/css" href="./css/editor.css">
    <link rel="stylesheet" type="text/css" href="./css/short-tutorial.css">

   
    <style type="text/css">code{white-space: pre;}

      .dropdown-menu {
          min-width: 0px;
      }
      
      #checker-status {
          width: 30;
          height: 20;
          padding-top: 2px;
          padding-right: 10px;
          position: absolute;
          top: 0;
          right: 0;
          z-index:99;
      }
    </style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>


<!-- <script type="text/javascript" src="js/jquery/jquery-1.7.1.min.js"></script> -->
<script type="text/javascript" src="./js/jquery/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="./js/angular/angular.js"></script>
<script type="text/javascript" src="./js/bootstrap/bootstrap.js"></script>
<script type="text/javascript" src="./js/short-tutorial.js"></script>

<!-- MATHJAX TEMPLATES GO HERE -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    extensions: ["color.js"],
    Macros: {
      True: "\\mathit{True}",
      RR:   "{\\bf R}",
      Int:  "\\mathtt{Int}",
      Nat:  "\\mathtt{Nat}",
      Zero: "\\mathtt{Zero}",
      foo:   ["{\\bf Jhala FOO #1}", 1],
      kvar:  ["{\\color[rgb]{1,0,0}{K_{#1}({#2})}}", 2],
      bindx: ["{{#1}\\!:\\!{#2}}", 2],
      reft:  ["\\{\\bindx{#1}{#2} \\mid {#3}\\}", 3],
      ereft: ["\\bindx{#1}{\\{#2 \\mid #3\\}}", 3],
      reftx: ["\\{{#1}\\mid{#2}\\}", 2],
      inferrule: ["\\frac{#2}{#3}\\;{#1}", 3],
      tcap:  ["(\\mathtt{intersection}\\ #1\\ #2)", 2],
      tcup:  ["(\\mathtt{union}\\ #1\\ #2)", 2],
      tsng:  ["(\\mathtt{singleton}\\ #1)", 1]
  }
  }
});
</script>

<!-- GITHUB -->
<script
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  type="text/javascript"></script>
  
<!-- LOCAL 

  <script src="js/MathJax-2.6.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    type="text/javascript"></script>
    
  -->
  







</head>
<body class="rustdoc" data-spy="scroll" data-target=".bs-docs-sidebar" ng-app="liquidDemo" ng-controller="LiquidDemoCtrl">

    <div id="nav">
       <button id="toggle-nav" class="toggle-nav">
         <span class="sr-only">Toggle navigation</span>
         <span class="bar"></span>
         <span class="bar"></span>
         <span class="bar"></span>
       </button>
    </div>

<div id='toc' class='mobile-hidden'>
<ul class='chapter'>
<li><a href='Tutorial_01_Introduction.html'><b>1.</b>Introduction</a></li>
<ul class='section'>
<li><a href='Tutorial_01_Introduction.html#'><b>1.1.</b> Well-Typed Programs Do Go Wrong</a></li>
<li><a href='Tutorial_01_Introduction.html#'><b>1.2.</b> Refinement Types</a></li>
</ul>
<li><a href='Tutorial_03_Basic.html'><b>2.</b>Refinement Types</a></li>
<ul class='section'>
<li><a href='Tutorial_03_Basic.html#'><b>2.1.</b> Defining Types</a></li>
<li><a href='Tutorial_03_Basic.html#'><b>2.2.</b> Errors</a></li>
<li><a href='Tutorial_03_Basic.html#'><b>2.3.</b> Subtyping</a></li>
<li><a href='Tutorial_03_Basic.html#'><b>2.4.</b> Writing Specifications</a></li>
<li><a href='Tutorial_03_Basic.html#'><b>2.5.</b> Refining Function Types: Post-conditions</a></li>
<li><a href='Tutorial_03_Basic.html#'><b>2.6.</b> Dependent Refinements</a></li>
</ul>
<li><a href='Tutorial_05_Datatypes.html'><b>3.</b>Refined Datatypes</a></li>
<ul class='section'>
<li><a href='Tutorial_05_Datatypes.html#'><b>3.1.</b> Sparse Vectors</a></li>
</ul>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html'><b>4.</b>Case Study: Okasaki's Lazy Queues</a></li>
<ul class='section'>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html#'><b>4.1.</b> Queues</a></li>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html#'><b>4.2.</b> Sized Lists</a></li>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html#'><b>4.3.</b> Queue Type</a></li>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html#'><b>4.4.</b> Queue Operations</a></li>
<li><a href='Tutorial_09_Case_Study_Lazy_Queues.html#'><b>4.5.</b> Recap of everyting!</a></li>
</ul>
<li><a href='Tutorial_Cheat_sheet.html'><b>5.</b>Cheat Sheet</a></li>
<ul class='section'>
<li><a href='Tutorial_Cheat_sheet.html#'><b>5.1.</b> Specifications</a></li>
<li><a href='Tutorial_Cheat_sheet.html#'><b>5.2.</b> Alias</a></li>
<li><a href='Tutorial_Cheat_sheet.html#'><b>5.3.</b> Liquid types in Datatypes</a></li>
<li><a href='Tutorial_Cheat_sheet.html#'><b>5.4.</b> Measures</a></li>
</ul>
<li><a href='test.html'><b>6.</b>Refined Datatypes</a></li>
<ul class='section'>
<li><a href='test.html#'><b>6.1.</b> Sparse Vectors</a></li>
</ul>
</ul>

</div>
      
       <div id="checker-status">
         <!-- Verifying ... -->
         <button class="btn btn-xs btn-link actbutton" type="button" style="font-size:30px; z-index:1"
                ng-show="isChecking" ng-click="verifySource()">
          <span class="glyphicon glyphicon-hourglass"></span>
         </button>

        
         <!-- Safe -->
         <button class="btn btn-xs btn-link actbutton" type="button" style="font-size:30px; color:green; z-index:1"
                 ng-show="isSafe">
           <span class="glyphicon glyphicon-ok"></span>
         </button>

         <div class="dropdown" ng-show="isBad">
             <button class="btn btn-xs btn-link dropdown-toggle"
                     type="button"
                     id="errorblockdropdown"
                     data-toggle="dropdown"
                     style="font-size:30px; color:red; z-index:1">
               <span class="glyphicon glyphicon-remove" style="vertical-align:middle"></span><font size="4">{{errorBlocks.length}}</font>
               </span>
             </button>
             <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
               <li ng-repeat="err in errorBlocks">
                 <a tabindex="-1" ng-href="#program-{{err.data}}">{{err.index}}</a>
               </li>
             </ul>
         </div>
       </div>
       

<div id='page-wrapper'>
<div id='page'>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<div class="hidden">
<div id="program-pane-0" class="welleditor" style="background:#fff; position:relative">

  <!-- Verify Source -->
  <button class="btn btn-xs btn-link actbutton" type="button" style="z-index:1"
          ng-show="isUnknown" ng-click="verifySource()">
    <span class="glyphicon glyphicon-play"></span>
  </button>
 
  <div id="program-0" class="programbox">{-# LANGUAGE CPP #-}

module Tutorial_01_Introduction where
main = putStrLn "Intro"

-- {-@ ignore average @-}

</div>
</div>

</div>

<p>Welcome to the LiquidHaskell Short Tutorial, where you will learn the
basic workings of LiquidHaskell and complete some exercises. The full
version of the tutorial can be found in the <a
href="https://ucsd-progsys.github.io/liquidhaskell-tutorial/Tutorial_01_Introduction.html">projectâ€™s
website</a>.</p>
<p>One of the great things about Haskell is its brainy type system that
allows one to enforce a variety of invariants at compile time, thereby
nipping in the bud a large swathe of run-time errors.</p>
<section id="well-typed-programs-do-go-wrong" class="level2">
<h2>Well-Typed Programs Do Go Wrong</h2>
<p>Alas, well-typed programs <em>do</em> go quite wrong, in a variety of
ways.</p>
<p><br />
<strong>Division by Zero</strong> This innocuous function computes the
average of a list of integers:</p>
<div id="program-pane-1" class="welleditor" style="background:#fff; position:relative">

  <!-- Verify Source -->
  <button class="btn btn-xs btn-link actbutton" type="button" style="z-index:1"
          ng-show="isUnknown" ng-click="verifySource()">
    <span class="glyphicon glyphicon-play"></span>
  </button>
 
  <div id="program-1" class="programbox">average    :: [Int] -> Int
average xs = sum xs `div` length xs</div>
</div>

<p>We get the desired result on a non-empty list of numbers:</p>
<pre class="ghci"><code>ghci&gt; average [10, 20, 30, 40]
25</code></pre>
<div id="question1" class="interact"
style="width=640px;border= 2px solid #3498db; border-radius= 10px;">
<p>
However, this program crashes with certain arguments. From the following
options, what argument would make <code>average</code> crash?
</p>
<label class="container"> [1] <input type="radio" name="q1" value="1">
<span class="checkmark"></span> </label><br> <label class="container">
[] <input type="radio" name="q1" value="2"><span
class="checkmark"></span> </label><br> <label class="container">
[1,1,1,1,1,1,1,1,1,1,1] <input type="radio" name="q1" value="3"><span
class="checkmark"></span> </label><br>
<button class="btn-select" onclick="checkAnswer(1)">Submit</button>
<p id="result1">
</p>
<p><input type="hidden" id="correctAnswer1" value="2"></p>
<button class="btn-answer" onclick="toggleCollapsible(1)">
Answer</button>
<div id="collapsibleDiv1">
If we call it with an empty list, we get a rather unpleasant crash: ***
Exception: divide by zero. We could write <code>average</code> more
<em>defensively</em>, returning a <code>Maybe</code> or
<code>Either</code> value. However, this merely kicks the can down the
road. Ultimately, we will want to extract the <code>Int</code> from the
<code>Maybe</code> and if the inputs were invalid to start with, then at
that point weâ€™d be stuck.<br />

</div>
</div>
<p><br/></p>
<p>For certain kinds of programs, there is a fate worse than death.
<code>text</code> is a high-performance string processing library for
Haskell, that is used, for example, to build web services.</p>
<pre class="ghci"><code>ghci&gt; :m +Data.Text Data.Text.Unsafe
ghci&gt; let t = pack &quot;Voltage&quot;
ghci&gt; takeWord16 5 t
&quot;Volta&quot;</code></pre>
<p>A cunning adversary can use invalid, or rather,
<em>well-crafted</em>, inputs that go well outside the size of the given
<code>text</code> to read extra bytes and thus <em>extract secrets</em>
without anyone being any the wiser.</p>
<pre class="ghci"><code>ghci&gt; takeWord16 20 t
&quot;Voltage\1912\3148\SOH\NUL\15928\2486\SOH\NUL&quot;</code></pre>
<p>The above call returns the bytes residing in memory <em>immediately
after</em> the string <code>Voltage</code>. These bytes could be junk,
or could be either the name of your favorite TV show, or, more
worryingly, your bank account password.</p>
</section>
<section id="refinement-types" class="level2">
<h2>Refinement Types</h2>
<p>Refinement types allow us to enrich Haskellâ€™s type system with
<em>predicates</em> that precisely describe the sets of <em>valid</em>
inputs and outputs of functions, values held inside containers, and so
on. These predicates are drawn from special <em>logics</em> for which
there are fast <em>decision procedures</em> called SMT solvers.</p>
<p><br />
<strong>By combining types with predicates</strong> you can specify
<em>contracts</em> which describe valid inputs and outputs of functions.
The refinement type system <em>guarantees at compile-time</em> that
functions adhere to their contracts. That is, you can rest assured that
the above calamities <em>cannot occur at run-time</em>.</p>
<p><br />
<strong>LiquidHaskell</strong> is a Refinement Type Checker for Haskell,
and in this tutorial weâ€™ll describe how you can use it to make programs
better and programming even more fun.</p>
As a glimpse of what LiquidHaskell can do, run the average example below
by pushing the green triangle on the top, and try to read the error
message. Since <code>div</code> cannot take a zero value as the second
argument, and LiquidHaskell sees that it is a possibility in this
function, an error will be raised.
<div id="program-pane-2" class="welleditor" style="background:#fff; position:relative">

  <!-- Verify Source -->
  <button class="btn btn-xs btn-link actbutton" type="button" style="z-index:1"
          ng-show="isUnknown" ng-click="verifySource()">
    <span class="glyphicon glyphicon-play"></span>
  </button>
 
  <div id="program-2" class="programbox">average'    :: [Int] -> Int
average' xs =  sum xs `div` length xs</div>
</div>

<p>In this tutorial you will learn how to add and reason about
refinement types in Haskell, and how it can increase the realiability of
Haskell problems.</p>
<p><a href="Tutorial_03_Basic.html" >
<button class="btn-next">Next</button> </a></p>
</section>
</section>

</div>
</div>

<div class="hidden">
<!--Site Meter -->
  <script type="text/javascript" src="//s23.sitemeter.com/js/counter.js?site=s23liquidtypes"></script>
  <noscript>
    <a href="http://s23.sitemeter.com/stats.asp?site=s23liquidtypes" 
      target="_top">
      <img src="http://s23.sitemeter.com/meter.asp?site=s23liquidtypes" 
      alt="Site Meter" border="0"/></a>
  </noscript>
  <!-- Copyright (c)2009 Site Meter -->
</div>





<!-- JavaScript below! ============================================== -->

  <script src="./js/ace/ace.js" type="text/javascript" charset="utf-8"></script> 
  <script src="./js/ace/theme-monokai.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/ace/mode-haskell.js"  type="text/javascript" charset="utf-8"></script>
  <script src="./js/liquid/tooltip.js"></script> 
  <script src="./js/liquid/annot.js"></script> 
  <script src="./js/liquid/config.js"></script> 
  <script src="./js/liquid/liquid.js"></script>

  <script type="text/javascript">
    var queryServerURL = "https://liquid-demo.programming.systems/" ;
  </script>
  
  <!-- rust nav JS --> 
  <script type="text/javascript">
    window.playgroundUrl = "";
  </script>
  
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {

 document.getElementById("toggle-nav").onclick = toggleNav;

  function toggleNav() {
    var toc         = document.getElementById("toc");
    var pagewrapper = document.getElementById("page-wrapper");
    var status      = document.getElementById("checker-status");

    toggleClass(toc,         "mobile-hidden");
    // toggleClass(status,      "mobile-hidden");
    toggleClass(pagewrapper, "mobile-hidden");
  };

  function toggleClass(el, className) {
     // from http://youmightnotneedjquery.com/
     if (el.classList) {
       el.classList.toggle(className);
     } else {
       var classes = el.className.split(' ');
       var existingIndex = classes.indexOf(className);

       if (existingIndex >= 0) {
         classes.splice(existingIndex, 1);
       } else {
         classes.push(className);
       }
       el.className = classes.join(' ');
     }
  }
});
</script>
</body>
</html>
